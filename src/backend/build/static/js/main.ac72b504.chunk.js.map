{"version":3,"sources":["lib/search.js","lib/page.js","index.js"],"names":["searchResultProps","rows","headers","key","header","MySearch","shouldComponentUpdate","newProps","newState","render","react_default","a","createElement","Search","id","placeHolderText","size","labelText","onChange","_this","props","searchQueryOnChange","document","getElementById","value","React","Component","SearchResult","searchResultItems","_this2","items","map","item","TableRow","TableCell","concat","name","artists","album","src","images","url","className","Math","round","duration_ms","OverflowMenu","flipped","OverflowMenuItem","itemText","DataTable","_ref","getHeaderProps","getTableProps","getRowProps","getTableContainerProps","TableContainer","Table","TableHead","TableHeader","Object","assign","TableBody","SearchPane","_this3","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","abortController","AbortController","_ref2","asyncToGenerator","regenerator_default","mark","_callee","searchQuery","oldState","newItems","requestOptions","response","responseObj","wrap","_context","prev","next","state","method","Authorization","access_token","redirect","signal","fetch","sent","t0","JSON","text","t1","parse","tracks","objectSpread","setState","stop","_x","apply","arguments","Fragment","search_MySearch","search_SearchResult","abort","bottomSheetProps","overflowHeight","shadowTip","topShadow","overlay","scrollTopAtClose","Page","spotifyLogout","window","location","replace","profileImages","userID","room","users","push","profileImageURL","HeaderContainer","Header","aria-label","HeaderName","prefix","HeaderNavigation","HeaderGlobalBar","HeaderGlobalAction","onClick","bucket_10","Grid","Row","Column","sm","span","md","lg","search_SearchPane","SwipeableBottomSheet_default","spotifyID","URLSearchParams","search","get","backendURL","undefined","socket","io","on","emit","simpleRoom","console","log","lib_page","accessToken"],"mappings":"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","file":"static/js/main.ac72b504.chunk.js","sourcesContent":["import React from \"react\";\n// import { render } from \"react-dom\";\nimport {\n  DataTable,\n  TableContainer,\n  Table,\n  TableHead,\n  TableRow,\n  TableHeader,\n  TableBody,\n  TableCell,\n  Search,\n  OverflowMenu,\n  OverflowMenuItem,\n} from \"carbon-components-react\";\nimport styles from \"./search.css\";\nconst searchResultProps = {\n  rows: [],\n  headers: [\n    {\n      key: \"name\",\n      header: \"Name\",\n    },\n    {\n      key: \"artist\",\n      header: \"Artist\",\n    },\n    {\n      key: \"album\",\n      header: \"Album\",\n    },\n    {\n      key: \"duration\",\n      header: \"Duration\",\n    },\n    {\n      key: \"overflow\",\n      header: \"\",\n    },\n  ],\n};\n\nclass MySearch extends React.Component {\n  shouldComponentUpdate = (newProps, newState) => false;\n\n  render = () => {\n    return (\n      <Search\n        id=\"search\"\n        placeHolderText={\"Find a song\"}\n        size={\"lg\"}\n        labelText=\"search\"\n        onChange={() => {\n          this.props.searchQueryOnChange(\n            document.getElementById(\"search\").value\n          );\n        }}\n      />\n    );\n  };\n}\n\nclass SearchResult extends React.Component {\n  render = () => {\n    const searchResultItems = this.props.items.map((item) => {\n      return (\n        <TableRow id={item.id} key={item.id}>\n          <TableCell key={`${item.id}:name`}>{item.name}</TableCell>\n          <TableCell key={`${item.id}:artist`}>\n            {item.artists[0].name}\n          </TableCell>\n          <TableCell key={`${item.id}:album`}>\n            {item.album.name}\n            <img\n              src={`${item.album.images[0].url}`}\n              className=\"albumPhoto\"\n            ></img>\n          </TableCell>\n          <TableCell key={`${item.id}:duration`}>\n            {Math.round((item.duration_ms * 10) / 1000 / 60) / 10} minutes\n          </TableCell>\n          <TableCell key=\"overflow\">\n            <OverflowMenu flipped>\n              <OverflowMenuItem itemText=\"Queue\"></OverflowMenuItem>\n            </OverflowMenu>\n          </TableCell>\n        </TableRow>\n      );\n    });\n\n    return (\n      <DataTable {...searchResultProps}>\n        {({\n          rows,\n          headers,\n          getHeaderProps,\n          getRowProps,\n          getTableProps,\n          getTableContainerProps,\n        }) => (\n          <TableContainer {...getTableContainerProps()}>\n            <Table {...getTableProps()}>\n              <TableHead>\n                <TableRow>\n                  {headers.map((header) => (\n                    <TableHeader\n                      key={header.key}\n                      {...getHeaderProps({ header })}\n                    >\n                      {header.header}\n                    </TableHeader>\n                  ))}\n                </TableRow>\n              </TableHead>\n              <TableBody>{searchResultItems}</TableBody>\n            </Table>\n          </TableContainer>\n        )}\n      </DataTable>\n    );\n  };\n}\n\nclass SearchPane extends React.Component {\n  // https://medium.com/@selvaganesh93/how-to-clean-up-subscriptions-in-react-components-using-abortcontroller-72335f19b6f7\n  abortController = new AbortController();\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      items: [],\n    };\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  searchQueryOnChange = async (searchQuery) => {\n    let oldState = this.state;\n    let newItems = [];\n    if (searchQuery) {\n      let requestOptions = {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${this.props.access_token}` },\n        redirect: \"follow\",\n        signal: this.abortController.signal,\n      };\n\n      let response = await fetch(\n        `https://api.spotify.com/v1/search?q=${searchQuery}&type=track`,\n        requestOptions\n      );\n      let responseObj = JSON.parse(await response.text());\n      newItems = responseObj.tracks.items;\n    }\n    let newState = { ...oldState, ...{ items: newItems } };\n    this.setState(newState);\n  };\n\n  render = () => {\n    return (\n      <>\n        <MySearch searchQueryOnChange={this.searchQueryOnChange}></MySearch>\n        <SearchResult {...this.state}></SearchResult>\n      </>\n    );\n  };\n}\nexport { SearchPane };\n","import React from \"react\";\n// import { render } from \"react-dom\";\nimport {\n  Header,\n  HeaderName,\n  HeaderNavigation,\n  HeaderContainer,\n  HeaderGlobalBar,\n  HeaderGlobalAction,\n  Grid,\n  Row,\n  Column,\n} from \"carbon-components-react\";\nimport SwipeableBottomSheet from \"react-swipeable-bottom-sheet\";\nimport { Logout20 } from \"@carbon/icons-react\";\nimport { SearchPane } from \"./search\";\nimport styles from \"./page.css\";\n\nconst bottomSheetProps = {\n  overflowHeight: 48,\n  shadowTip: false,\n  topShadow: false,\n  overlay: false,\n  scrollTopAtClose: true,\n};\n\nclass Page extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  spotifyLogout = () => {\n    window.location.replace(\"https://www.spotify.com/logout/\");\n  };\n\n  render() {\n    const profileImages = [];\n    for (let userID in this.props.room.users) {\n      profileImages.push(\n        <img\n          key={`${userID}_profilePhoto`}\n          className=\"profilePhoto\"\n          src={this.props.room.users[userID].profileImageURL}\n        ></img>\n      );\n    }\n    return (\n      <div id=\"page\">\n        <HeaderContainer\n          render={() => (\n            <>\n              <Header aria-label=\"Nitrus\">\n                <HeaderName prefix=\"\">Nitrus</HeaderName>\n                <HeaderNavigation aria-label=\"Nitrus\">\n                  {profileImages}\n                </HeaderNavigation>\n                <HeaderGlobalBar>\n                  <HeaderGlobalAction\n                    id=\"logoutIcon\"\n                    aria-label=\"Logout\"\n                    onClick={this.spotifyLogout}\n                  >\n                    <Logout20 />\n                  </HeaderGlobalAction>\n                </HeaderGlobalBar>\n              </Header>\n              <Grid>\n                <Row>\n                  <Column id=\"DesktopQueue\" sm={{ span: 0 }} md={2} lg={3}>\n                    Queue\n                  </Column>\n                  <Column sm={4} md={6} lg={9}>\n                    <SearchPane\n                      access_token={this.props.access_token}\n                    ></SearchPane>\n                  </Column>\n\n                  <Column sm={1} md={{ span: 0 }} lg={{ span: 0 }}>\n                    <SwipeableBottomSheet {...bottomSheetProps}>\n                      <div id=\"MobileQueue\"></div>\n                    </SwipeableBottomSheet>\n                  </Column>\n                </Row>\n              </Grid>\n            </>\n          )}\n        />\n        {/* <pre>{JSON.stringify(this.props, null, 2)}</pre> */}\n      </div>\n    );\n  }\n}\nexport default Page;\n","import React from \"react\";\nimport { render } from \"react-dom\";\nimport io from \"socket.io-client\";\nimport Page from \"./lib/page\";\n\nconst urlSearchParams = new URLSearchParams(window.location.search);\nconst spotifyID = urlSearchParams.get(\"spotifyID\");\n\n// https://www.npmjs.com/package/socket.io-client\n// const backendURL = \"http://0.0.0.0\";\nconst backendURL = \"https://nitrus.azurewebsites.net\";\n\nlet access_token = undefined;\nlet room = undefined;\n\nconst socket = io(backendURL);\nsocket.on(\"connect\", () => {\n  socket.emit(\"init\", spotifyID);\n});\n\nsocket.on(\"redirectToLogin\", () => {\n  window.location.replace(`${backendURL}/login`);\n});\n\nsocket.on(\"setRoom\", (simpleRoom) => {\n  room = simpleRoom;\n  console.log(\"new room\", room);\n  render(\n    <Page room={room} access_token={access_token} />,\n    document.getElementById(\"root\")\n  );\n});\n\nsocket.on(\"setAccessToken\", (accessToken) => {\n  access_token = accessToken;\n  console.log(\"new access token\", access_token);\n  render(\n    <Page room={room} access_token={access_token} />,\n    document.getElementById(\"root\")\n  );\n});\n\n// render(<Page />, document.getElementById(\"root\"));\n"],"sourceRoot":""}